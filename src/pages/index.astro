---
import BaseLayout from "../layouts/BaseLayout.astro";
import HorizontalCard from "../components/HorizontalCard.astro";
import { getCollection } from "astro:content";
import createSlug from "../lib/createSlug";

const posts = (await getCollection("blog")).sort(
  (a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf()
);

const last_posts = posts.slice(0, 3);

// ---- EDIT THESE LINKS ONCE AND YOU'RE DONE ----
const CONNECT_LINK = "mailto:gautham@growthtodo.com";
const BLOG_PAGE = "/blog";
// ------------------------------------------------

// Only 2 active projects on homepage (in this order)
const currentProjects = [
  {
    title: "SellOnTube",
    img: "/post_img.webp",
    desc:
      "YouTube-first customer acquisition for internet businesses â€” strategy, execution, and productization.",
    url: "https://sellontube.com",
    badge: "ACTIVE",
  },
  {
    title: "The Second Design",
    img: "/post_img.webp",
    desc:
      "An education design studio â€” curriculum, cohort-based learning, facilitator training, and transformational learning environments.",
    url: "https://theseconddesign.com",
    badge: "ACTIVE",
  },
];
---

<BaseLayout sideBarActiveItemID="home">
  <!-- HERO -->
  <div class="pb-12 mt-5">
    <div class="text-xl py-1">Hey there ðŸ‘‹</div>

    <div class="text-5xl font-bold">I'm Gautham</div>

    <div class="text-3xl py-3 font-bold">
      Founderâ€“operator building internet-first businesses.
    </div>

    <div class="py-2">
      <p class="text-lg">
        Growth To Do is where I document what I'm building, what I'm learning, and how I help founders
        cut through the noise and turn clarity into a to-do list they can execute.
      </p>
      <p class="text-lg mt-3">
        If youâ€™re building an internet-first product (SaaS, D2C, education, info-products) and youâ€™re
        stuck, overwhelmed, or spinning â€” I can help you get unstuck fast.
      </p>
    </div>

    <div class="mt-8 flex flex-wrap gap-4">
      <a class="btn" href={CONNECT_LINK}>Let's connect</a>

      <a class="btn btn-outline" href={BLOG_PAGE}>
        Read the blog
      </a>
    </div>
  </div>

  <!-- CURRENT PROJECTS -->
  <div class="flex items-end justify-between gap-4">
    <div class="text-3xl w-full font-bold mb-2">Current projects</div>
  </div>

  {currentProjects.map((p, idx) => (
    <>
      <HorizontalCard
        title={p.title}
        img={p.img}
        desc={p.desc}
        url={p.url}
        badge={p.badge}
        target="_blank"
      />
      {idx !== currentProjects.length - 1 && <div class="divider my-0"></div>}
    </>
  ))}

  <!-- LATEST BLOG -->
  <div>
    <div class="text-3xl w-full font-bold mb-5 mt-10">Latest from the blog</div>
  </div>

  {last_posts.map((post) => (
    <>
      <HorizontalCard
        title={post.data.title}
        img={post.data.heroImage}
        desc={post.data.description}
        url={"/blog/" + createSlug(post.data.title, post.slug)}
        target="_self"
        badge={post.data.badge}
      />
      <div class="divider my-0" />
    </>
  ))}
</BaseLayout>